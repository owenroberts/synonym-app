extends layout
block content
	div.error
		div.msg
			div.sorry= "We couldn't find a path. Sorry about that!"
			div.errormsg
			div.ok
				div="OK"
	div#main
		header
			div.menu
				a(href="/")
					svg(class="stroke" width="22" height="22" viewBox="0 0 20 20")
						path(fill="none" stroke="#C7C8CA" stroke-width="2" stroke-linecap="round" d="M17.2 7.6H1.1M17.2 1.2H1.1M17.2 14H1.1")
		div.index
			form(method="get", action="/search", id="search")
				input(type="text",  name="s", class="query")
				input(type="text",  name="e"  , class="query")
				input(type="hidden",value="10",name="nl")
				input(type="hidden",value="10",name="sl")
				input(type="submit", value="search")
			div.ldr
				img(src='/img/loader.svg')

	// ** javascript ** // 
	script(type="text/javascript").

		var fadeDur = 500;
		var termsEntered = [false, false];

		$('a').on('click', function(ev) {
			ev.preventDefault();
			window.location = this.href;
		});

		var submitForm = function() {
			$('.ldr').fadeIn().css("display","inline-block");
			$('input[value="search"]').fadeOut(10);
			setTimeout( function() {
				$("#search").submit();
			}, fadeDur*2);
			$('input[type="text"]').animate({
				"background-color":"transparent"
			}, fadeDur);
		}

		$('input[value="search"]').on('click', function(ev) {
			ev.preventDefault();
			submitForm();
		});

		$('.query').on('change keydown  paste', function(event) {
			//- if (event.which == 32) {
			//- 	if (this.name == "s") {
			//- 		$('input[name=e]').focus();
			//- 	} else {

			//- 	}
			//- }
			termsEntered[$(this).index()] = true;
			if (termsEntered[0] && termsEntered[1]) {
				$('input[value="search"]').css({color: '#6a75ff'});
			}
		})

		function reportError(errmsg) {
			$('.error').fadeIn();
			$('.errormsg').text("Hint: " + errmsg);
			$('.ok').on('click', function() {
				$('.error').fadeOut();
			});
			location.hash = "";
		}
		if ("#{errmsg}") reportError("#{errmsg}");
